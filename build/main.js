!function(){var t={717:function(t,e){!function(t){"use strict";class e{constructor(t,e){this.state={angle:0,area:[],position:{x:0,y:0},hardAngle:0,hardDrawingAngle:0},this.createdDensity=e,this.nowDrawingDensity=this.createdDensity,this.render=t}setDensity(t){this.createdDensity=t,this.nowDrawingDensity=t}setDrawingDensity(t){this.nowDrawingDensity=t}setPosition(t){this.state.position=t}setAngle(t){this.state.angle=t}setArea(t){this.state.area=t}setHardDrawingAngle(t){this.state.hardDrawingAngle=t}setHardAngle(t){this.state.hardAngle=t,this.state.hardDrawingAngle=t}setOrientation(t){this.orientation=t}getDrawingDensity(){return this.nowDrawingDensity}getDensity(){return this.createdDensity}getHardAngle(){return this.state.hardAngle}}class s extends e{constructor(t,e,s){super(t,s),this.image=null,this.isLoad=!1,this.loadingAngle=0,this.image=new Image,this.image.src=e}draw(t){const e=this.render.getContext(),s=this.render.convertToGlobal(this.state.position),i=this.render.getRect().pageWidth,n=this.render.getRect().height;e.save(),e.translate(s.x,s.y),e.beginPath();for(let t of this.state.area)null!==t&&(t=this.render.convertToGlobal(t),e.lineTo(t.x-s.x,t.y-s.y));e.rotate(this.state.angle),e.clip(),this.isLoad?e.drawImage(this.image,0,0,i,n):this.drawLoader(e,{x:0,y:0},i,n),e.restore()}simpleDraw(t){const e=this.render.getRect(),s=this.render.getContext(),i=e.pageWidth,n=e.height,a=1===t?e.left+e.pageWidth:e.left,o=e.top;this.isLoad?s.drawImage(this.image,a,o,i,n):this.drawLoader(s,{x:a,y:o},i,n)}drawLoader(t,e,s,i){t.beginPath(),t.strokeStyle="rgb(200, 200, 200)",t.fillStyle="rgb(255, 255, 255)",t.lineWidth=1,t.rect(e.x+1,e.y+1,s-1,i-1),t.stroke(),t.fill();const n={x:e.x+s/2,y:e.y+i/2};t.beginPath(),t.lineWidth=10,t.arc(n.x,n.y,20,this.loadingAngle,3*Math.PI/2+this.loadingAngle),t.stroke(),t.closePath(),this.loadingAngle+=.07,this.loadingAngle>=2*Math.PI&&(this.loadingAngle=0)}load(){this.isLoad||(this.image.onload=()=>{this.isLoad=!0})}newTemporaryCopy(){return this}getTemporaryCopy(){return this}hideTemporaryCopy(){}}class i{constructor(t,e){this.pages=[],this.currentPageIndex=0,this.currentSpreadIndex=0,this.landscapeSpread=[],this.portraitSpread=[],this.render=e,this.app=t,this.currentPageIndex=0,this.isShowCover=this.app.getSettings().showCover}destroy(){this.pages=[]}createSpread(){this.landscapeSpread=[],this.portraitSpread=[];for(let t=0;t<this.pages.length;t++)this.portraitSpread.push([t]);let t=0;this.isShowCover&&(this.pages[0].setDensity("hard"),this.landscapeSpread.push([t]),t++);for(let e=t;e<this.pages.length;e+=2)e<this.pages.length-1?this.landscapeSpread.push([e,e+1]):(this.landscapeSpread.push([e]),this.pages[e].setDensity("hard"))}getSpread(){return"landscape"===this.render.getOrientation()?this.landscapeSpread:this.portraitSpread}getSpreadIndexByPage(t){const e=this.getSpread();for(let s=0;s<e.length;s++)if(t===e[s][0]||t===e[s][1])return s;return null}getPageCount(){return this.pages.length}getPages(){return this.pages}getPage(t){if(t>=0&&t<this.pages.length)return this.pages[t];throw new Error("Invalid page number")}nextBy(t){const e=this.pages.indexOf(t);return e<this.pages.length-1?this.pages[e+1]:null}prevBy(t){const e=this.pages.indexOf(t);return e>0?this.pages[e-1]:null}getFlippingPage(t){const e=this.currentSpreadIndex;if("portrait"===this.render.getOrientation())return 0===t?this.pages[e].newTemporaryCopy():this.pages[e-1];{const s=0===t?this.getSpread()[e+1]:this.getSpread()[e-1];return 1===s.length||0===t?this.pages[s[0]]:this.pages[s[1]]}}getBottomPage(t){const e=this.currentSpreadIndex;if("portrait"===this.render.getOrientation())return 0===t?this.pages[e+1]:this.pages[e-1];{const s=0===t?this.getSpread()[e+1]:this.getSpread()[e-1];return 1===s.length?this.pages[s[0]]:0===t?this.pages[s[1]]:this.pages[s[0]]}}showNext(){this.currentSpreadIndex<this.getSpread().length&&(this.currentSpreadIndex++,this.showSpread())}showPrev(){this.currentSpreadIndex>0&&(this.currentSpreadIndex--,this.showSpread())}getCurrentPageIndex(){return this.currentPageIndex}show(t=null){if(null===t&&(t=this.currentPageIndex),t<0||t>=this.pages.length)return;const e=this.getSpreadIndexByPage(t);null!==e&&(this.currentSpreadIndex=e,this.showSpread())}getCurrentSpreadIndex(){return this.currentSpreadIndex}setCurrentSpreadIndex(t){if(!(t>=0&&t<this.getSpread().length))throw new Error("Invalid page");this.currentSpreadIndex=t}showSpread(){const t=this.getSpread()[this.currentSpreadIndex];2===t.length?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(this.pages[t[1]])):"landscape"===this.render.getOrientation()&&t[0]===this.pages.length-1?(this.render.setLeftPage(this.pages[t[0]]),this.render.setRightPage(null)):(this.render.setLeftPage(null),this.render.setRightPage(this.pages[t[0]])),this.currentPageIndex=t[0],this.app.updatePageIndex(this.currentPageIndex)}}class n extends i{constructor(t,e,s){super(t,e),this.imagesHref=s}load(){for(const t of this.imagesHref){const e=new s(this.render,t,"soft");e.load(),this.pages.push(e)}this.createSpread()}}class a{static GetDistanceBetweenTwoPoint(t,e){return null===t||null===e?1/0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}static GetSegmentLength(t){return a.GetDistanceBetweenTwoPoint(t[0],t[1])}static GetAngleBetweenTwoLine(t,e){const s=t[0].y-t[1].y,i=e[0].y-e[1].y,n=t[1].x-t[0].x,a=e[1].x-e[0].x;return Math.acos((s*i+n*a)/(Math.sqrt(s*s+n*n)*Math.sqrt(i*i+a*a)))}static PointInRect(t,e){return null===e?null:e.x>=t.left&&e.x<=t.width+t.left&&e.y>=t.top&&e.y<=t.top+t.height?e:null}static GetRotatedPoint(t,e,s){return{x:t.x*Math.cos(s)+t.y*Math.sin(s)+e.x,y:t.y*Math.cos(s)-t.x*Math.sin(s)+e.y}}static LimitPointToCircle(t,e,s){if(a.GetDistanceBetweenTwoPoint(t,s)<=e)return s;const i=t.x,n=t.y,o=s.x,r=s.y;let c=Math.sqrt(Math.pow(e,2)*Math.pow(i-o,2)/(Math.pow(i-o,2)+Math.pow(n-r,2)))+i;s.x<0&&(c*=-1);let l=(c-i)*(n-r)/(i-o)+n;return i-o+n===0&&(l=e),{x:c,y:l}}static GetIntersectBetweenTwoSegment(t,e,s){return a.PointInRect(t,a.GetIntersectBeetwenTwoLine(e,s))}static GetIntersectBeetwenTwoLine(t,e){const s=t[0].y-t[1].y,i=e[0].y-e[1].y,n=t[1].x-t[0].x,a=e[1].x-e[0].x,o=t[0].x*t[1].y-t[1].x*t[0].y,r=e[0].x*e[1].y-e[1].x*e[0].y,c=s*r-i*o,l=n*r-a*o,g=-(o*a-r*n)/(s*a-i*n),h=-(s*r-i*o)/(s*a-i*n);if(isFinite(g)&&isFinite(h))return{x:g,y:h};if(Math.abs(c-l)<.1)throw new Error("Segment included");return null}static GetCordsFromTwoPoint(t,e){const s=Math.abs(t.x-e.x),i=Math.abs(t.y-e.y),n=Math.max(s,i),a=[t];function o(t,e,s,i,n){return e>t?t+n*(s/i):e<t?t-n*(s/i):t}for(let r=1;r<=n;r+=1)a.push({x:o(t.x,e.x,s,n,r),y:o(t.y,e.y,i,n,r)});return a}}class o extends e{constructor(t,e,s){super(t,s),this.copiedElement=null,this.temporaryCopy=null,this.isLoad=!1,this.element=e,this.element.classList.add("stf__item"),this.element.classList.add("--"+s)}newTemporaryCopy(){return"hard"===this.nowDrawingDensity?this:(null===this.temporaryCopy&&(this.copiedElement=this.element.cloneNode(!0),this.element.parentElement.appendChild(this.copiedElement),this.temporaryCopy=new o(this.render,this.copiedElement,this.nowDrawingDensity)),this.getTemporaryCopy())}getTemporaryCopy(){return this.temporaryCopy}hideTemporaryCopy(){null!==this.temporaryCopy&&(this.copiedElement.remove(),this.copiedElement=null,this.temporaryCopy=null)}draw(t){const e=t||this.nowDrawingDensity,s=this.render.convertToGlobal(this.state.position),i=this.render.getRect().pageWidth,n=this.render.getRect().height;this.element.classList.remove("--simple");const a=`\n            display: block;\n            z-index: ${this.element.style.zIndex};\n            left: 0;\n            top: 0;\n            width: ${i}px;\n            height: ${n}px;\n        `;"hard"===e?this.drawHard(a):this.drawSoft(s,a)}drawHard(t=""){const e=this.render.getRect().left+this.render.getRect().width/2,s=this.state.hardDrawingAngle,i=t+"\n                backface-visibility: hidden;\n                -webkit-backface-visibility: hidden;\n                clip-path: none;\n                -webkit-clip-path: none;\n            "+(0===this.orientation?`transform-origin: ${this.render.getRect().pageWidth}px 0; \n                   transform: translate3d(0, 0, 0) rotateY(${s}deg);`:`transform-origin: 0 0; \n                   transform: translate3d(${e}px, 0, 0) rotateY(${s}deg);`);this.element.style.cssText=i}drawSoft(t,e=""){let s="polygon( ";for(const t of this.state.area)if(null!==t){let e=1===this.render.getDirection()?{x:-t.x+this.state.position.x,y:t.y-this.state.position.y}:{x:t.x-this.state.position.x,y:t.y-this.state.position.y};e=a.GetRotatedPoint(e,{x:0,y:0},this.state.angle),s+=e.x+"px "+e.y+"px, "}s=s.slice(0,-2),s+=")";const i=e+`transform-origin: 0 0; clip-path: ${s}; -webkit-clip-path: ${s};`+(this.render.isSafari()&&0===this.state.angle?`transform: translate(${t.x}px, ${t.y}px);`:`transform: translate3d(${t.x}px, ${t.y}px, 0) rotate(${this.state.angle}rad);`);this.element.style.cssText=i}simpleDraw(t){const e=this.render.getRect(),s=e.pageWidth,i=e.height,n=1===t?e.left+e.pageWidth:e.left,a=e.top;this.element.classList.add("--simple"),this.element.style.cssText=`\n            position: absolute; \n            display: block; \n            height: ${i}px; \n            left: ${n}px; \n            top: ${a}px; \n            width: ${s}px; \n            z-index: ${this.render.getSettings().startZIndex+1};`}getElement(){return this.element}load(){this.isLoad=!0}setOrientation(t){super.setOrientation(t),this.element.classList.remove("--left","--right"),this.element.classList.add(1===t?"--right":"--left")}setDrawingDensity(t){this.element.classList.remove("--soft","--hard"),this.element.classList.add("--"+t),super.setDrawingDensity(t)}}class r extends i{constructor(t,e,s,i){super(t,e),this.element=s,this.pagesElement=i}load(){for(const t of this.pagesElement){const e=new o(this.render,t,"hard"===t.dataset.density?"hard":"soft");e.load(),this.pages.push(e)}this.createSpread()}}class c{constructor(t,e,s,i){this.direction=t,this.corner=e,this.topIntersectPoint=null,this.sideIntersectPoint=null,this.bottomIntersectPoint=null,this.pageWidth=parseInt(s,10),this.pageHeight=parseInt(i,10)}calc(t){try{return this.position=this.calcAngleAndPosition(t),this.calculateIntersectPoint(this.position),!0}catch(t){return!1}}getFlippingClipArea(){const t=[];let e=!1;return t.push(this.rect.topLeft),t.push(this.topIntersectPoint),null===this.sideIntersectPoint?e=!0:(t.push(this.sideIntersectPoint),null===this.bottomIntersectPoint&&(e=!1)),t.push(this.bottomIntersectPoint),(e||"bottom"===this.corner)&&t.push(this.rect.bottomLeft),t}getBottomClipArea(){const t=[];return t.push(this.topIntersectPoint),"top"===this.corner?t.push({x:this.pageWidth,y:0}):(null!==this.topIntersectPoint&&t.push({x:this.pageWidth,y:0}),t.push({x:this.pageWidth,y:this.pageHeight})),null!==this.sideIntersectPoint?a.GetDistanceBetweenTwoPoint(this.sideIntersectPoint,this.topIntersectPoint)>=10&&t.push(this.sideIntersectPoint):"top"===this.corner&&t.push({x:this.pageWidth,y:this.pageHeight}),t.push(this.bottomIntersectPoint),t.push(this.topIntersectPoint),t}getAngle(){return 0===this.direction?-this.angle:this.angle}getRect(){return this.rect}getPosition(){return this.position}getActiveCorner(){return 0===this.direction?this.rect.topLeft:this.rect.topRight}getDirection(){return this.direction}getFlippingProgress(){return Math.abs((this.position.x-this.pageWidth)/(2*this.pageWidth)*100)}getCorner(){return this.corner}getBottomPagePosition(){return 1===this.direction?{x:this.pageWidth,y:0}:{x:0,y:0}}getShadowStartPoint(){return"top"===this.corner?this.topIntersectPoint:null!==this.sideIntersectPoint?this.sideIntersectPoint:this.topIntersectPoint}getShadowAngle(){const t=a.GetAngleBetweenTwoLine(this.getSegmentToShadowLine(),[{x:0,y:0},{x:this.pageWidth,y:0}]);return 0===this.direction?t:Math.PI-t}calcAngleAndPosition(t){let e=t;if(this.updateAngleAndGeometry(e),e="top"===this.corner?this.checkPositionAtCenterLine(e,{x:0,y:0},{x:0,y:this.pageHeight}):this.checkPositionAtCenterLine(e,{x:0,y:this.pageHeight},{x:0,y:0}),Math.abs(e.x-this.pageWidth)<1&&Math.abs(e.y)<1)throw new Error("Point is too small");return e}updateAngleAndGeometry(t){this.angle=this.calculateAngle(t),this.rect=this.getPageRect(t)}calculateAngle(t){const e=this.pageWidth-t.x+1,s="bottom"===this.corner?this.pageHeight-t.y:t.y;let i=2*Math.acos(e/Math.sqrt(s*s+e*e));s<0&&(i=-i);const n=Math.PI-i;if(!isFinite(i)||n>=0&&n<.003)throw new Error("The G point is too small");return"bottom"===this.corner&&(i=-i),i}getPageRect(t){return"top"===this.corner?this.getRectFromBasePoint([{x:0,y:0},{x:this.pageWidth,y:0},{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}],t):this.getRectFromBasePoint([{x:0,y:-this.pageHeight},{x:this.pageWidth,y:-this.pageHeight},{x:0,y:0},{x:this.pageWidth,y:0}],t)}getRectFromBasePoint(t,e){return{topLeft:this.getRotatedPoint(t[0],e),topRight:this.getRotatedPoint(t[1],e),bottomLeft:this.getRotatedPoint(t[2],e),bottomRight:this.getRotatedPoint(t[3],e)}}getRotatedPoint(t,e){return{x:t.x*Math.cos(this.angle)+t.y*Math.sin(this.angle)+e.x,y:t.y*Math.cos(this.angle)-t.x*Math.sin(this.angle)+e.y}}calculateIntersectPoint(t){const e={left:-1,top:-1,width:this.pageWidth+2,height:this.pageHeight+2};"top"===this.corner?(this.topIntersectPoint=a.GetIntersectBetweenTwoSegment(e,[t,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=a.GetIntersectBetweenTwoSegment(e,[t,this.rect.bottomLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=a.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}])):(this.topIntersectPoint=a.GetIntersectBetweenTwoSegment(e,[this.rect.topLeft,this.rect.topRight],[{x:0,y:0},{x:this.pageWidth,y:0}]),this.sideIntersectPoint=a.GetIntersectBetweenTwoSegment(e,[t,this.rect.topLeft],[{x:this.pageWidth,y:0},{x:this.pageWidth,y:this.pageHeight}]),this.bottomIntersectPoint=a.GetIntersectBetweenTwoSegment(e,[this.rect.bottomLeft,this.rect.bottomRight],[{x:0,y:this.pageHeight},{x:this.pageWidth,y:this.pageHeight}]))}checkPositionAtCenterLine(t,e,s){let i=t;const n=a.LimitPointToCircle(e,this.pageWidth,i);i!==n&&(i=n,this.updateAngleAndGeometry(i));const o=Math.sqrt(Math.pow(this.pageWidth,2)+Math.pow(this.pageHeight,2));let r=this.rect.bottomRight,c=this.rect.topLeft;if("bottom"===this.corner&&(r=this.rect.topRight,c=this.rect.bottomLeft),r.x<=0){const t=a.LimitPointToCircle(s,o,c);t!==i&&(i=t,this.updateAngleAndGeometry(i))}return i}getSegmentToShadowLine(){const t=this.getShadowStartPoint();return[t,t!==this.sideIntersectPoint&&null!==this.sideIntersectPoint?this.sideIntersectPoint:this.bottomIntersectPoint]}}class l{constructor(t,e){this.flippingPage=null,this.bottomPage=null,this.calc=null,this.state="read",this.render=t,this.app=e}fold(t){this.setState("user_fold"),null===this.calc&&this.start(t),this.do(this.render.convertToPage(t))}flip(t){if(this.app.getSettings().disableFlipByClick&&!this.isPointOnCorners(t))return;if(null!==this.calc&&this.render.finishAnimation(),!this.start(t))return;const e=this.getBoundsRect();this.setState("flipping");const s=e.height/10,i="bottom"===this.calc.getCorner()?e.height-s:s,n="bottom"===this.calc.getCorner()?e.height:0;this.calc.calc({x:e.pageWidth-s,y:i}),this.animateFlippingTo({x:e.pageWidth-s,y:i},{x:-e.pageWidth,y:n},!0)}start(t){this.reset();const e=this.render.convertToBook(t),s=this.getBoundsRect(),i=this.getDirectionByPoint(e),n=e.y>=s.height/2?"bottom":"top";if(!this.checkDirection(i))return!1;try{if(this.flippingPage=this.app.getPageCollection().getFlippingPage(i),this.bottomPage=this.app.getPageCollection().getBottomPage(i),"landscape"===this.render.getOrientation())if(1===i){const t=this.app.getPageCollection().nextBy(this.flippingPage);null!==t&&this.flippingPage.getDensity()!==t.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),t.setDrawingDensity("hard"))}else{const t=this.app.getPageCollection().prevBy(this.flippingPage);null!==t&&this.flippingPage.getDensity()!==t.getDensity()&&(this.flippingPage.setDrawingDensity("hard"),t.setDrawingDensity("hard"))}return this.render.setDirection(i),this.calc=new c(i,n,s.pageWidth.toString(10),s.height.toString(10)),!0}catch(t){return!1}}do(t){if(null!==this.calc&&this.calc.calc(t)){const t=this.calc.getFlippingProgress();this.bottomPage.setArea(this.calc.getBottomClipArea()),this.bottomPage.setPosition(this.calc.getBottomPagePosition()),this.bottomPage.setAngle(0),this.bottomPage.setHardAngle(0),this.flippingPage.setArea(this.calc.getFlippingClipArea()),this.flippingPage.setPosition(this.calc.getActiveCorner()),this.flippingPage.setAngle(this.calc.getAngle()),0===this.calc.getDirection()?this.flippingPage.setHardAngle(90*(200-2*t)/100):this.flippingPage.setHardAngle(-90*(200-2*t)/100),this.render.setPageRect(this.calc.getRect()),this.render.setBottomPage(this.bottomPage),this.render.setFlippingPage(this.flippingPage),this.render.setShadowData(this.calc.getShadowStartPoint(),this.calc.getShadowAngle(),t,this.calc.getDirection())}}flipToPage(t,e){const s=this.app.getPageCollection().getCurrentSpreadIndex(),i=this.app.getPageCollection().getSpreadIndexByPage(t);try{i>s&&(this.app.getPageCollection().setCurrentSpreadIndex(i-1),this.flipNext(e)),i<s&&(this.app.getPageCollection().setCurrentSpreadIndex(i+1),this.flipPrev(e))}catch(t){}}flipNext(t){this.flip({x:this.render.getRect().left+2*this.render.getRect().pageWidth-10,y:"top"===t?1:this.render.getRect().height-2})}flipPrev(t){this.flip({x:10,y:"top"===t?1:this.render.getRect().height-2})}stopMove(){if(null===this.calc)return;const t=this.calc.getPosition(),e=this.getBoundsRect(),s="bottom"===this.calc.getCorner()?e.height:0;t.x<=0?this.animateFlippingTo(t,{x:-e.pageWidth,y:s},!0):this.animateFlippingTo(t,{x:e.pageWidth,y:s},!1)}showCorner(t){if(!this.checkState("read","fold_corner"))return;const e=this.getBoundsRect(),s=e.pageWidth;if(this.isPointOnCorners(t))if(null===this.calc){if(!this.start(t))return;this.setState("fold_corner"),this.calc.calc({x:s-1,y:1});const i=50,n="bottom"===this.calc.getCorner()?e.height-1:1,a="bottom"===this.calc.getCorner()?e.height-i:i;this.animateFlippingTo({x:s-1,y:n},{x:s-i,y:a},!1,!1)}else this.do(this.render.convertToPage(t));else this.setState("read"),this.render.finishAnimation(),this.stopMove()}animateFlippingTo(t,e,s,i=!0){const n=a.GetCordsFromTwoPoint(t,e),o=[];for(const t of n)o.push((()=>this.do(t)));const r=this.getAnimationDuration(n.length);this.render.startAnimation(o,r,(()=>{this.calc&&(s&&(1===this.calc.getDirection()?this.app.turnToPrevPage():this.app.turnToNextPage()),i&&(this.render.setBottomPage(null),this.render.setFlippingPage(null),this.render.clearShadow(),this.setState("read"),this.reset()))}))}getCalculation(){return this.calc}getState(){return this.state}setState(t){this.state!==t&&(this.app.updateState(t),this.state=t)}getDirectionByPoint(t){const e=this.getBoundsRect();if("portrait"===this.render.getOrientation()){if(t.x-e.pageWidth<=e.width/5)return 1}else if(t.x<e.width/2)return 1;return 0}getAnimationDuration(t){const e=this.app.getSettings().flippingTime;return t>=1e3?e:t/1e3*e}checkDirection(t){return 0===t?this.app.getCurrentPageIndex()<this.app.getPageCount()-1:this.app.getCurrentPageIndex()>=1}reset(){this.calc=null,this.flippingPage=null,this.bottomPage=null}getBoundsRect(){return this.render.getRect()}checkState(...t){for(const e of t)if(this.state===e)return!0;return!1}isPointOnCorners(t){const e=this.getBoundsRect(),s=e.pageWidth,i=Math.sqrt(Math.pow(s,2)+Math.pow(e.height,2))/5,n=this.render.convertToBook(t);return n.x>0&&n.y>0&&n.x<e.width&&n.y<e.height&&(n.x<i||n.x>e.width-i)&&(n.y<i||n.y>e.height-i)}}class g{constructor(t,e){this.leftPage=null,this.rightPage=null,this.flippingPage=null,this.bottomPage=null,this.direction=null,this.orientation=null,this.shadow=null,this.animation=null,this.pageRect=null,this.boundsRect=null,this.timer=0,this.safari=!1,this.setting=e,this.app=t;const s=new RegExp("Version\\/[\\d\\.]+.*Safari/");this.safari=null!==s.exec(window.navigator.userAgent)}render(t){if(null!==this.animation){const e=Math.round((t-this.animation.startedAt)/this.animation.durationFrame);e<this.animation.frames.length?this.animation.frames[e]():(this.animation.onAnimateEnd(),this.animation=null)}this.timer=t,this.drawFrame()}start(){this.update();const t=e=>{this.render(e),requestAnimationFrame(t)};requestAnimationFrame(t)}startAnimation(t,e,s){this.finishAnimation(),this.animation={frames:t,duration:e,durationFrame:e/t.length,onAnimateEnd:s,startedAt:this.timer}}finishAnimation(){null!==this.animation&&(this.animation.frames[this.animation.frames.length-1](),null!==this.animation.onAnimateEnd&&this.animation.onAnimateEnd()),this.animation=null}update(){this.boundsRect=null;const t=this.calculateBoundsRect();this.orientation!==t&&(this.orientation=t,this.app.updateOrientation(t))}calculateBoundsRect(){let t="landscape";const e=this.getBlockWidth(),s=e/2,i=this.getBlockHeight()/2,n=this.setting.width/this.setting.height;let a=this.setting.width,o=this.setting.height,r=s-a;return"stretch"===this.setting.size?(e<2*this.setting.minWidth&&this.app.getSettings().usePortrait&&(t="portrait"),a="portrait"===t?this.getBlockWidth():this.getBlockWidth()/2,a>this.setting.maxWidth&&(a=this.setting.maxWidth),o=a/n,o>this.getBlockHeight()&&(o=this.getBlockHeight(),a=o*n),r="portrait"===t?s-a/2-a:s-a):e<2*a&&this.app.getSettings().usePortrait&&(t="portrait",r=s-a/2-a),this.boundsRect={left:r,top:i-o/2,width:2*a,height:o,pageWidth:a},t}setShadowData(t,e,s,i){if(!this.app.getSettings().drawShadow)return;const n=100*this.getSettings().maxShadowOpacity;this.shadow={pos:t,angle:e,width:3*this.getRect().pageWidth/4*s/100,opacity:(100-s)*n/100/100,direction:i,progress:2*s}}clearShadow(){this.shadow=null}getBlockWidth(){return this.app.getUI().getDistElement().offsetWidth}getBlockHeight(){return this.app.getUI().getDistElement().offsetHeight}getDirection(){return this.direction}getRect(){return null===this.boundsRect&&this.calculateBoundsRect(),this.boundsRect}getSettings(){return this.app.getSettings()}getOrientation(){return this.orientation}setPageRect(t){this.pageRect=t}setDirection(t){this.direction=t}setRightPage(t){null!==t&&t.setOrientation(1),this.rightPage=t}setLeftPage(t){null!==t&&t.setOrientation(0),this.leftPage=t}setBottomPage(t){null!==t&&t.setOrientation(1===this.direction?0:1),this.bottomPage=t}setFlippingPage(t){null!==t&&t.setOrientation(0===this.direction&&"portrait"!==this.orientation?0:1),this.flippingPage=t}convertToBook(t){const e=this.getRect();return{x:t.x-e.left,y:t.y-e.top}}isSafari(){return this.safari}convertToPage(t,e){e||(e=this.direction);const s=this.getRect();return{x:0===e?t.x-s.left-s.width/2:s.width/2-t.x+s.left,y:t.y-s.top}}convertToGlobal(t,e){if(e||(e=this.direction),null==t)return null;const s=this.getRect();return{x:0===e?t.x+s.left+s.width/2:s.width/2-t.x+s.left,y:t.y+s.top}}convertRectToGlobal(t,e){return e||(e=this.direction),{topLeft:this.convertToGlobal(t.topLeft,e),topRight:this.convertToGlobal(t.topRight,e),bottomLeft:this.convertToGlobal(t.bottomLeft,e),bottomRight:this.convertToGlobal(t.bottomRight,e)}}}class h extends g{constructor(t,e,s){super(t,e),this.canvas=s,this.ctx=s.getContext("2d")}getContext(){return this.ctx}reload(){}drawFrame(){this.clear(),"portrait"!==this.orientation&&null!=this.leftPage&&this.leftPage.simpleDraw(0),null!=this.rightPage&&this.rightPage.simpleDraw(1),null!=this.bottomPage&&this.bottomPage.draw(),this.drawBookShadow(),null!=this.flippingPage&&this.flippingPage.draw(),null!=this.shadow&&(this.drawOuterShadow(),this.drawInnerShadow());const t=this.getRect();"portrait"===this.orientation&&(this.ctx.beginPath(),this.ctx.rect(t.left+t.pageWidth,t.top,t.width,t.height),this.ctx.clip())}drawBookShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=t.width/20;this.ctx.rect(t.left,t.top,t.width,t.height);const s={x:t.left+t.width/2-e/2,y:0};this.ctx.translate(s.x,s.y);const i=this.ctx.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(0, 0, 0, 0)"),i.addColorStop(.4,"rgba(0, 0, 0, 0.2)"),i.addColorStop(.49,"rgba(0, 0, 0, 0.1)"),i.addColorStop(.5,"rgba(0, 0, 0, 0.5)"),i.addColorStop(.51,"rgba(0, 0, 0, 0.4)"),i.addColorStop(1,"rgba(0, 0, 0, 0)"),this.ctx.clip(),this.ctx.fillStyle=i,this.ctx.fillRect(0,0,e,2*t.height),this.ctx.restore()}drawOuterShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(t.left,t.top,t.width,t.height);const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y});this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const s=this.ctx.createLinearGradient(0,0,this.shadow.width,0);0===this.shadow.direction?(this.ctx.translate(0,-100),s.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),s.addColorStop(1,"rgba(0, 0, 0, 0)")):(this.ctx.translate(-this.shadow.width,-100),s.addColorStop(0,"rgba(0, 0, 0, 0)"),s.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")")),this.ctx.clip(),this.ctx.fillStyle=s,this.ctx.fillRect(0,0,this.shadow.width,2*t.height),this.ctx.restore()}drawInnerShadow(){const t=this.getRect();this.ctx.save(),this.ctx.beginPath();const e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),s=this.convertRectToGlobal(this.pageRect);this.ctx.moveTo(s.topLeft.x,s.topLeft.y),this.ctx.lineTo(s.topRight.x,s.topRight.y),this.ctx.lineTo(s.bottomRight.x,s.bottomRight.y),this.ctx.lineTo(s.bottomLeft.x,s.bottomLeft.y),this.ctx.translate(e.x,e.y),this.ctx.rotate(Math.PI+this.shadow.angle+Math.PI/2);const i=3*this.shadow.width/4,n=this.ctx.createLinearGradient(0,0,i,0);0===this.shadow.direction?(this.ctx.translate(-i,-100),n.addColorStop(1,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(.9,"rgba(0, 0, 0, 0.05)"),n.addColorStop(.7,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(0,"rgba(0, 0, 0, 0)")):(this.ctx.translate(0,-100),n.addColorStop(0,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(.1,"rgba(0, 0, 0, 0.05)"),n.addColorStop(.3,"rgba(0, 0, 0, "+this.shadow.opacity+")"),n.addColorStop(1,"rgba(0, 0, 0, 0)")),this.ctx.clip(),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,i,2*t.height),this.ctx.restore()}clear(){this.ctx.fillStyle="white",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}}class d{constructor(t,e,s){this.touchPoint=null,this.swipeTimeout=250,this.onResize=()=>{this.update()},this.onMouseDown=t=>{if(this.checkTarget(t.target)){const e=this.getMousePos(t.clientX,t.clientY);this.app.startUserTouch(e),t.preventDefault()}},this.onTouchStart=t=>{if(this.checkTarget(t.target)&&t.changedTouches.length>0){const e=t.changedTouches[0],s=this.getMousePos(e.clientX,e.clientY);this.touchPoint={point:s,time:Date.now()},setTimeout((()=>{null!==this.touchPoint&&this.app.startUserTouch(s)}),this.swipeTimeout),this.app.getSettings().mobileScrollSupport||t.preventDefault()}},this.onMouseUp=t=>{const e=this.getMousePos(t.clientX,t.clientY);this.app.userStop(e)},this.onMouseMove=t=>{const e=this.getMousePos(t.clientX,t.clientY);this.app.userMove(e,!1)},this.onTouchMove=t=>{if(t.changedTouches.length>0){const e=t.changedTouches[0],s=this.getMousePos(e.clientX,e.clientY);this.app.getSettings().mobileScrollSupport?(null!==this.touchPoint&&(Math.abs(this.touchPoint.point.x-s.x)>10||"read"!==this.app.getState())&&t.cancelable&&this.app.userMove(s,!0),"read"!==this.app.getState()&&t.preventDefault()):this.app.userMove(s,!0)}},this.onTouchEnd=t=>{if(t.changedTouches.length>0){const e=t.changedTouches[0],s=this.getMousePos(e.clientX,e.clientY);let i=!1;if(null!==this.touchPoint){const t=s.x-this.touchPoint.point.x,e=Math.abs(s.y-this.touchPoint.point.y);Math.abs(t)>this.swipeDistance&&e<2*this.swipeDistance&&Date.now()-this.touchPoint.time<this.swipeTimeout&&(t>0?this.app.flipPrev(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"):this.app.flipNext(this.touchPoint.point.y<this.app.getRender().getRect().height/2?"top":"bottom"),i=!0),this.touchPoint=null}this.app.userStop(s,i)}},this.parentElement=t,t.classList.add("stf__parent"),t.insertAdjacentHTML("afterbegin",'<div class="stf__wrapper"></div>'),this.wrapper=t.querySelector(".stf__wrapper"),this.app=e;const i=this.app.getSettings().usePortrait?1:2;t.style.minWidth=s.minWidth*i+"px",t.style.minHeight=s.minHeight+"px","fixed"===s.size&&(t.style.minWidth=s.width*i+"px",t.style.minHeight=s.height+"px"),s.autoSize&&(t.style.width="100%",t.style.maxWidth=2*s.maxWidth+"px"),t.style.display="block",window.addEventListener("resize",this.onResize,!1),this.swipeDistance=s.swipeDistance}destroy(){this.app.getSettings().useMouseEvents&&this.removeHandlers(),this.distElement.remove(),this.wrapper.remove()}getDistElement(){return this.distElement}getWrapper(){return this.wrapper}setOrientationStyle(t){this.wrapper.classList.remove("--portrait","--landscape"),"portrait"===t?(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/this.app.getSettings().width*100+"%"),this.wrapper.classList.add("--portrait")):(this.app.getSettings().autoSize&&(this.wrapper.style.paddingBottom=this.app.getSettings().height/(2*this.app.getSettings().width)*100+"%"),this.wrapper.classList.add("--landscape")),this.update()}removeHandlers(){window.removeEventListener("resize",this.onResize),this.distElement.removeEventListener("mousedown",this.onMouseDown),this.distElement.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("mouseup",this.onMouseUp),window.removeEventListener("touchend",this.onTouchEnd)}setHandlers(){window.addEventListener("resize",this.onResize,!1),this.app.getSettings().useMouseEvents&&(this.distElement.addEventListener("mousedown",this.onMouseDown),this.distElement.addEventListener("touchstart",this.onTouchStart),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("touchmove",this.onTouchMove,{passive:!this.app.getSettings().mobileScrollSupport}),window.addEventListener("mouseup",this.onMouseUp),window.addEventListener("touchend",this.onTouchEnd))}getMousePos(t,e){const s=this.distElement.getBoundingClientRect();return{x:t-s.left,y:e-s.top}}checkTarget(t){return!this.app.getSettings().clickEventForward||!["a","button"].includes(t.tagName.toLowerCase())}}class p extends d{constructor(t,e,s,i){super(t,e,s),this.wrapper.insertAdjacentHTML("afterbegin",'<div class="stf__block"></div>'),this.distElement=t.querySelector(".stf__block"),this.items=i;for(const t of i)this.distElement.appendChild(t);this.setHandlers()}clear(){for(const t of this.items)this.parentElement.appendChild(t)}updateItems(t){this.removeHandlers(),this.distElement.innerHTML="";for(const e of t)this.distElement.appendChild(e);this.items=t,this.setHandlers()}update(){this.app.getRender().update()}}class m extends d{constructor(t,e,s){super(t,e,s),this.wrapper.innerHTML='<canvas class="stf__canvas"></canvas>',this.canvas=t.querySelectorAll("canvas")[0],this.distElement=this.canvas,this.resizeCanvas(),this.setHandlers()}resizeCanvas(){const t=getComputedStyle(this.canvas),e=parseInt(t.getPropertyValue("width"),10),s=parseInt(t.getPropertyValue("height"),10);this.canvas.width=e,this.canvas.height=s}getCanvas(){return this.canvas}update(){this.resizeCanvas(),this.app.getRender().update()}}class u extends g{constructor(t,e,s){super(t,e),this.outerShadow=null,this.innerShadow=null,this.hardShadow=null,this.hardInnerShadow=null,this.element=s,this.createShadows()}createShadows(){this.element.insertAdjacentHTML("beforeend",'<div class="stf__outerShadow"></div>\n             <div class="stf__innerShadow"></div>\n             <div class="stf__hardShadow"></div>\n             <div class="stf__hardInnerShadow"></div>'),this.outerShadow=this.element.querySelector(".stf__outerShadow"),this.innerShadow=this.element.querySelector(".stf__innerShadow"),this.hardShadow=this.element.querySelector(".stf__hardShadow"),this.hardInnerShadow=this.element.querySelector(".stf__hardInnerShadow")}clearShadow(){super.clearShadow(),this.outerShadow.style.cssText="display: none",this.innerShadow.style.cssText="display: none",this.hardShadow.style.cssText="display: none",this.hardInnerShadow.style.cssText="display: none"}reload(){this.element.querySelector(".stf__outerShadow")||this.createShadows()}drawHardInnerShadow(){const t=this.getRect(),e=this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress;let s=(100-e)*(2.5*t.pageWidth)/100+20;s>t.pageWidth&&(s=t.pageWidth);let i=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+5).toString(10)};\n            width: ${s}px;\n            height: ${t.height}px;\n            background: linear-gradient(to right,\n                rgba(0, 0, 0, ${this.shadow.opacity*e/100}) 5%,\n                rgba(0, 0, 0, 0) 100%);\n            left: ${t.left+t.width/2}px;\n            transform-origin: 0 0;\n        `;i+=0===this.getDirection()&&this.shadow.progress>100||1===this.getDirection()&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0);":"transform: translate3d(0, 0, 0) rotateY(180deg);",this.hardInnerShadow.style.cssText=i}drawHardOuterShadow(){const t=this.getRect();let e=(100-(this.shadow.progress>100?200-this.shadow.progress:this.shadow.progress))*(2.5*t.pageWidth)/100+20;e>t.pageWidth&&(e=t.pageWidth);let s=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+4).toString(10)};\n            width: ${e}px;\n            height: ${t.height}px;\n            background: linear-gradient(to left, rgba(0, 0, 0, ${this.shadow.opacity}) 5%, rgba(0, 0, 0, 0) 100%);\n            left: ${t.left+t.width/2}px;\n            transform-origin: 0 0;\n        `;s+=0===this.getDirection()&&this.shadow.progress>100||1===this.getDirection()&&this.shadow.progress<=100?"transform: translate3d(0, 0, 0) rotateY(180deg);":"transform: translate3d(0, 0, 0);",this.hardShadow.style.cssText=s}drawInnerShadow(){const t=this.getRect(),e=3*this.shadow.width/4,s=0===this.getDirection()?e:0,i=0===this.getDirection()?"to left":"to right",n=this.convertToGlobal(this.shadow.pos),o=this.shadow.angle+3*Math.PI/2,r=[this.pageRect.topLeft,this.pageRect.topRight,this.pageRect.bottomRight,this.pageRect.bottomLeft];let c="polygon( ";for(const t of r){let e=1===this.getDirection()?{x:-t.x+this.shadow.pos.x,y:t.y-this.shadow.pos.y}:{x:t.x-this.shadow.pos.x,y:t.y-this.shadow.pos.y};e=a.GetRotatedPoint(e,{x:s,y:100},o),c+=e.x+"px "+e.y+"px, "}c=c.slice(0,-2),c+=")";const l=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+10).toString(10)};\n            width: ${e}px;\n            height: ${2*t.height}px;\n            background: linear-gradient(${i},\n                rgba(0, 0, 0, ${this.shadow.opacity}) 5%,\n                rgba(0, 0, 0, 0.05) 15%,\n                rgba(0, 0, 0, ${this.shadow.opacity}) 35%,\n                rgba(0, 0, 0, 0) 100%);\n            transform-origin: ${s}px 100px;\n            transform: translate3d(${n.x-s}px, ${n.y-100}px, 0) rotate(${o}rad);\n            clip-path: ${c};\n            -webkit-clip-path: ${c};\n        `;this.innerShadow.style.cssText=l}drawOuterShadow(){const t=this.getRect(),e=this.convertToGlobal({x:this.shadow.pos.x,y:this.shadow.pos.y}),s=this.shadow.angle+3*Math.PI/2,i=1===this.getDirection()?this.shadow.width:0,n=0===this.getDirection()?"to right":"to left",o=[{x:0,y:0},{x:t.pageWidth,y:0},{x:t.pageWidth,y:t.height},{x:0,y:t.height}];let r="polygon( ";for(const t of o)if(null!==t){let e=1===this.getDirection()?{x:-t.x+this.shadow.pos.x,y:t.y-this.shadow.pos.y}:{x:t.x-this.shadow.pos.x,y:t.y-this.shadow.pos.y};e=a.GetRotatedPoint(e,{x:i,y:100},s),r+=e.x+"px "+e.y+"px, "}r=r.slice(0,-2),r+=")";const c=`\n            display: block;\n            z-index: ${(this.getSettings().startZIndex+10).toString(10)};\n            width: ${this.shadow.width}px;\n            height: ${2*t.height}px;\n            background: linear-gradient(${n}, rgba(0, 0, 0, ${this.shadow.opacity}), rgba(0, 0, 0, 0));\n            transform-origin: ${i}px 100px;\n            transform: translate3d(${e.x-i}px, ${e.y-100}px, 0) rotate(${s}rad);\n            clip-path: ${r};\n            -webkit-clip-path: ${r};\n        `;this.outerShadow.style.cssText=c}drawLeftPage(){"portrait"!==this.orientation&&null!==this.leftPage&&(1===this.direction&&null!==this.flippingPage&&"hard"===this.flippingPage.getDrawingDensity()?(this.leftPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.leftPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.leftPage.draw(this.flippingPage.getDrawingDensity())):this.leftPage.simpleDraw(0))}drawRightPage(){null!==this.rightPage&&(0===this.direction&&null!==this.flippingPage&&"hard"===this.flippingPage.getDrawingDensity()?(this.rightPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.rightPage.setHardDrawingAngle(180+this.flippingPage.getHardAngle()),this.rightPage.draw(this.flippingPage.getDrawingDensity())):this.rightPage.simpleDraw(1))}drawBottomPage(){if(null===this.bottomPage)return;const t=null!=this.flippingPage?this.flippingPage.getDrawingDensity():null;"portrait"===this.orientation&&1===this.direction||(this.bottomPage.getElement().style.zIndex=(this.getSettings().startZIndex+3).toString(10),this.bottomPage.draw(t))}drawFrame(){this.clear(),this.drawLeftPage(),this.drawRightPage(),this.drawBottomPage(),null!=this.flippingPage&&(this.flippingPage.getElement().style.zIndex=(this.getSettings().startZIndex+5).toString(10),this.flippingPage.draw()),null!=this.shadow&&null!==this.flippingPage&&("soft"===this.flippingPage.getDrawingDensity()?(this.drawOuterShadow(),this.drawInnerShadow()):(this.drawHardOuterShadow(),this.drawHardInnerShadow()))}clear(){for(const t of this.app.getPageCollection().getPages())t!==this.leftPage&&t!==this.rightPage&&t!==this.flippingPage&&t!==this.bottomPage&&(t.getElement().style.cssText="display: none"),t.getTemporaryCopy()!==this.flippingPage&&t.hideTemporaryCopy()}update(){super.update(),null!==this.rightPage&&this.rightPage.setOrientation(1),null!==this.leftPage&&this.leftPage.setOrientation(0)}}class v{constructor(){this._default={startPage:0,size:"fixed",width:0,height:0,minWidth:0,maxWidth:0,minHeight:0,maxHeight:0,drawShadow:!0,flippingTime:1e3,usePortrait:!0,startZIndex:0,autoSize:!0,maxShadowOpacity:1,showCover:!1,mobileScrollSupport:!0,swipeDistance:30,clickEventForward:!0,useMouseEvents:!0,showPageCorners:!0,disableFlipByClick:!1}}getSettings(t){const e=this._default;if(Object.assign(e,t),"stretch"!==e.size&&"fixed"!==e.size)throw new Error('Invalid size type. Available only "fixed" and "stretch" value');if(e.width<=0||e.height<=0)throw new Error("Invalid width or height");if(e.flippingTime<=0)throw new Error("Invalid flipping time");return"stretch"===e.size?(e.minWidth<=0&&(e.minWidth=100),e.maxWidth<e.minWidth&&(e.maxWidth=2e3),e.minHeight<=0&&(e.minHeight=100),e.maxHeight<e.minHeight&&(e.maxHeight=2e3)):(e.minWidth=e.width,e.maxWidth=e.width,e.minHeight=e.height,e.maxHeight=e.height),e}}!function(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===s&&i.firstChild?i.insertBefore(n,i.firstChild):i.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}(".stf__parent {\n  position: relative;\n  display: block;\n  box-sizing: border-box;\n  transform: translateZ(0);\n\n  -ms-touch-action: pan-y;\n  touch-action: pan-y;\n}\n\n.sft__wrapper {\n  position: relative;\n  width: 100%;\n  box-sizing: border-box;\n}\n\n.stf__parent canvas {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n\n.stf__block {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  box-sizing: border-box;\n  perspective: 2000px;\n}\n\n.stf__item {\n  display: none;\n  position: absolute;\n  transform-style: preserve-3d;\n}\n\n.stf__outerShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n.stf__innerShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n.stf__hardShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n\n.stf__hardInnerShadow {\n  position: absolute;\n  left: 0;\n  top: 0;\n}"),t.PageFlip=class extends class{constructor(){this.events=new Map}on(t,e){return this.events.has(t)?this.events.get(t).push(e):this.events.set(t,[e]),this}off(t){this.events.delete(t)}trigger(t,e,s=null){if(this.events.has(t))for(const i of this.events.get(t))i({data:s,object:e})}}{constructor(t,e){super(),this.isUserTouch=!1,this.isUserMove=!1,this.setting=null,this.pages=null,this.setting=(new v).getSettings(e),this.block=t}destroy(){this.ui.destroy(),this.block.remove()}update(){this.render.update(),this.pages.show()}loadFromImages(t){this.ui=new m(this.block,this,this.setting);const e=this.ui.getCanvas();this.render=new h(this,this.setting,e),this.flipController=new l(this.render,this),this.pages=new n(this,this.render,t),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout((()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})}),1)}loadFromHTML(t){this.ui=new p(this.block,this,this.setting,t),this.render=new u(this,this.setting,this.ui.getDistElement()),this.flipController=new l(this.render,this),this.pages=new r(this,this.render,this.ui.getDistElement(),t),this.pages.load(),this.render.start(),this.pages.show(this.setting.startPage),setTimeout((()=>{this.ui.update(),this.trigger("init",this,{page:this.setting.startPage,mode:this.render.getOrientation()})}),1)}updateFromImages(t){const e=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new n(this,this.render,t),this.pages.load(),this.pages.show(e),this.trigger("update",this,{page:e,mode:this.render.getOrientation()})}updateFromHtml(t){const e=this.pages.getCurrentPageIndex();this.pages.destroy(),this.pages=new r(this,this.render,this.ui.getDistElement(),t),this.pages.load(),this.ui.updateItems(t),this.render.reload(),this.pages.show(e),this.trigger("update",this,{page:e,mode:this.render.getOrientation()})}clear(){this.pages.destroy(),this.ui.clear()}turnToPrevPage(){this.pages.showPrev()}turnToNextPage(){this.pages.showNext()}turnToPage(t){this.pages.show(t)}flipNext(t="top"){this.flipController.flipNext(t)}flipPrev(t="top"){this.flipController.flipPrev(t)}flip(t,e="top"){this.flipController.flipToPage(t,e)}updateState(t){this.trigger("changeState",this,t)}updatePageIndex(t){this.trigger("flip",this,t)}updateOrientation(t){this.ui.setOrientationStyle(t),this.update(),this.trigger("changeOrientation",this,t)}getPageCount(){return this.pages.getPageCount()}getCurrentPageIndex(){return this.pages.getCurrentPageIndex()}getPage(t){return this.pages.getPage(t)}getRender(){return this.render}getFlipController(){return this.flipController}getOrientation(){return this.render.getOrientation()}getBoundsRect(){return this.render.getRect()}getSettings(){return this.setting}getUI(){return this.ui}getState(){return this.flipController.getState()}getPageCollection(){return this.pages}startUserTouch(t){this.mousePosition=t,this.isUserTouch=!0,this.isUserMove=!1}userMove(t,e){this.isUserTouch||e||!this.setting.showPageCorners?this.isUserTouch&&a.GetDistanceBetweenTwoPoint(this.mousePosition,t)>5&&(this.isUserMove=!0,this.flipController.fold(t)):this.flipController.showCorner(t)}userStop(t,e=!1){this.isUserTouch&&(this.isUserTouch=!1,e||(this.isUserMove?this.flipController.stopMove():this.flipController.flip(t)))}},Object.defineProperty(t,"__esModule",{value:!0})}(e)}},e={};function s(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i].call(a.exports,a,a.exports,s),a.exports}!function(){"use strict";var t=s(717),e={BEFOREBEGIN:"beforebegin",AFTERBEGIN:"afterbegin",BEFOREEND:"beforeend",AFTEREND:"afterend"},i=[{page:"","btn-1":'<li><button id="choice-1" class="text-medium button-answer">Нужно попытаться найти дружелюбных князей, готовых помочь мальчику вернуть отчину. Уверен, такие найдутся!</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Необходимо обратиться за помощью к польскому королю, с которым у нас есть давние связи. Конечно, за свою помощь он попросит золото, серебро или часть земельных владений, но, вернув свои земли и заручившись верной дружиной, мы сможем легко вернуть все отданное обратно. Тем паче, что я знаю язык Ляхов. Я знал, что это мне не единожды пригодиться!</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Если честно, я, все-таки, не понимаю, зачем мне всё это нужно. Рисковать своей жизнью ради этого мальчика… Пойду-ка я лучше служить к другому князю, обзаведусь слугами и умру никому неизвестным боярином!</button></li>',"choice-1":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/4.png" alt="Съезд князей">\n                <figcaption class="text-img-author text-medium">Отравление Ростислава Владимировича Тмутараканского, первого князя-изгоя, греческим стратигом. Миниатюра из Радзивилловской летописи (XV век)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterH.svg" alt="Буква И" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    Отправив гонцов к ближайшим\n                    князьям, Вы либо не получаете\n                    никаких известий, либо получаете послания с отказами в помощи. \n                    Еще бы: кому нужно поддерживать молодого князя-изгоя, да еще и без большого воинства! \n                    А вот к западу от Русских земель такие силы как раз имеются. Силы, готовые за обещания земель или золота, помочь заполучить Вашему князю вожделенный престол. \n                    Вы отправляйтесь в Польшу и прибываете ко двору польского короля из династии Пястов, который довольно сносно Вас принимает, но, стоит отметить, без особого энтузиазма.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    ',"choice-2":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterP.svg" alt="Буква П" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    рибыв ко двору польского короля из\n                    династии Пястов, Вы очаровываите\n                    монарха и придворных своим знанием языка и обычаев. Польский король выделяет Вам и князю лучшие покои в своем замке, а также положительно отвечает на Ваше предложение о военном союзе. \n                    <br>\n                    <br>\n                    Впечатленный Вашим дипломатическим даром и даром толмача, князь не может сдержать своего восхищения.\n                    После аудиенции у польского короля Вы возвращайтесь в свои покои, куда Вам приносят княжеский вышитый пояс в качестве знака высшей признательности. \n                    Так, Вы не просто завоевали уважение своего князя, но и снискали его милость, что, конечно же, не применет сказаться на Вашем статусе и положении как при иноземных дворах, так и при будущем дворе Вашего князя.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/1.png" alt="Княжеский вышитый пояс">\n                <figcaption class="text-img-author text-medium">Княжеский вышитый пояс</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    ',"choice-3":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/4.png" alt="Съезд князей">\n                <figcaption class="text-img-author text-medium">Отравление Ростислава Владимировича Тмутараканского, первого князя-изгоя, греческим стратигом. Миниатюра из Радзивилловской летописи (XV век)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква И" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    ы не захотели прожить \n                    по-настоящему увлекательную и\n                    полную приключений жизнь. Вы умерли в безвестности, и не один летописец не счел нужным упомянуть о Вас хотя бы вкратце.\n                    </div>\n                </div>\n                <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    '},{page:'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/5.png" alt="Дуэль на мечах">\n                <figcaption class="text-img-author text-medium">Дуэль на мечах и баклерах (малых круглых щитах). Миниатюра из Манесского кодекса (ок. 1300 г.).</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n    </li>\n\n    <li class="page">\n        <div class="page-content content-text">\n            <div class=\'main-text\'> \n                <img src="assets/letter/letterY.svg" alt="Буква У" class=\'img-letter-small\'>\n                <div class=\'text text-small\'> \n                тром Вы просыпаетесь в своих покоях от стука в дверь. Открыв ее, \n                Вы видите перед собой придворного с посланием от короля. \n                Молодой правитель решил испытать Вас на прочность: он хочет устроить \n                турнир на мечах, в котором Вы должны доказать, что польская армия встает \n                на сторону умелого воина, а не слабака, не умеющего держать оружие!\n                </div>\n            </div>\n            <button id="choice" class="menu__button text-medium">Что будете делать?</button>\n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n        </div>\n    </li>',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Пора хватать князя в охапку и бежать из этой Польши! Еще русские витязи на их турнирах не дрались!</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Нужно согласиться на предложение короля. Однако, если он позволил себе такое, то чем мы хуже? Пусть в конце поединков он сам выйдет сразиться со мной на мечах!</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Я соглашусь биться на турнире с польскими рыцарями! Посмотрим, кто из нас сильнее!</button></li>',"choice-1":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/5.png" alt="Дуэль на мечах">\n                <figcaption class="text-img-author text-medium">Дуэль на мечах и баклерах (малых круглых щитах). Миниатюра из Манесского кодекса (ок. 1300 г.)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    ы прибегаете к князю, но тот смотрит на Вас, как на испуганного зайца. \n                    Ему пришлось самому взять в руки меч и пойти на турнир. Удивившись, монарх, \n                    тем не менее, разрешил поединки. В одном из них Ваш князь был смертельно ранен \n                    и вскоре отошел в мир иной. Вы же, оказавшись без князя \n                    и прослыв трусом на чужбине, всю оставшуюся жизнь провели серой мышью, \n                    над которой все насмехались.\n                    </div>\n                </div>\n                <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    ',"choice-2":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterP.svg" alt="Буква П" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    ольский монарх приятно удивлен Вашей храбростью. Любитель жарких битв и схваток \n                    на мечах, он с радостью принимает Ваше предложение. В конце турнира, \n                    когда все соперники побеждены Вами, он выходит с королевским мечом к Вам \n                    навстречу. Происходит короткая, но жесткая схватка, из которой Вы выходите победителем!\n                    <br>\n                    <br>\n                    Молодой польский король впечатлен Вашей храбростью и умением биться на мечах. \n                    В качестве знака своего почтения он преподносит Вам кольчугу, выкованную его \n                    лучшими кузнецами. Не изменив известиям об удали русских ратников, \n                    Вы с гордостью примеряете ее на себя: отныне Вам не страшны почти \n                    любые стрелы и палицы!\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/2.png" alt="Кольчуга">\n                <figcaption class="text-img-author text-medium">Кольчуга</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterH.svg" alt="Буква H" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    е остался в стороне от похвал и Ваш князь: впечатленный Вашими боевыми умениями, он, \n                    вспоминая рассказы из детства о великом князе Владимире Святославиче, \n                    награждает Вас именем «великого мужа». Отныне, Вы – храбрейший из храбрых не только \n                    в окружении молодого князя, но и во всех Польских землях. Слава о Вас начинает распространяться \n                    по всем краям и весям от польских берегов Вислы до испанских берегов Эбро. \n                    Миннезингеры, труверы, трубадуры и гусельники начинают слагать о Вас песни, разнося их \n                    по всей Европе! \n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/3.png" alt="Имя «великого мужа»">\n                <figcaption class="text-img-author text-medium">Имя «великого мужа»</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    ',"choice-3":'\n        \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterT.svg" alt="Буква T" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    урнир заканчивается, и все Ваши противники повержены Вами. \n                    Польский король аплодирует Вам, однако в душе переживает, что не отважился \n                    скрестить с Вами мечи. Тем не менее, он впечатлен Вашей храбростью и \n                    не стесняется хвалебных слов, посвященных Вашей силе и отваге.\n                    <br>\n                    <br>\n                    Не остался в стороне от похвал и Ваш князь: впечатленный Вашими боевыми умениями, он, \n                    вспоминая рассказы из детства о великом князе Владимире Святославиче, награждает Вас именем \n                    «великого мужа». Отныне, Вы – храбрейший из храбрых не только в окружении молодого князя, \n                    но и во всех Польских землях. Слава о Вас начинает распространяться по всем краям и весям \n                    от польских берегов Вислы до испанских берегов Эбро. Миннезингеры, труверы, трубадуры \n                    и гусельники начинают слагать о Вас песни, разнося их по всей Европе!\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/3.png" alt="Звание «Великого мужа»">\n                <figcaption class="text-img-author text-medium">Звание «Великого мужа»</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    '},{page:'\n        \n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/6.png" alt="Пленение поляками Володаря Ростиславича Перемышльского">\n                            <figcaption class="text-img-author text-medium">Пленение поляками при посредничестве Петра Власта (ум. 1153 г.) Володаря Ростиславича Перемышльского (ум. 1124 г.). 1122 г. Миниатюра из Радзивилловской летописи (рукопись конца XV в.)</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterH.svg" alt="Буква H" class=\'img-letter-small\'>\n                            <div class=\'text text-small\'> \n                            а следующий день Вы с молодым князем решили прогуляться по призамковой \n                            роще. Внезапно на вас нападает пара-тройка легковооруженных людей. В одном \n                            из нападавших Вы узнаете слугу князя, что вчера был повержен Вами \n                            в одном из поединков.\n                            </div>\n                        </div>\n                        <button id="choice" class="menu__button text-medium">Что же делать?</button>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n        ',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Надо вдвоем отбиваться от врагов! От моего трупа князю на чужбине будет мало проку. Победим заговорщиков, а дальше подумаем, что делать…</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Князь, беги! Попробую один отбиться от врагов, а потом найти князя в безопасных покоях замка.</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Я и не ожидал, что все будет настолько опасно! Надо бросать меч и бежать в лес!</button></li>',"choice-1":'\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    месте с князем Вы сражаетесь с врагами. Вскоре все они лежат на земле поверженные.\n                    <br>\n                    <br>\n                    Ошеломленный князь медленно садится на траву, слегка окропленную вечерней росой. \n                    Он не испуган, но весьма подавлен случившимся. Понимая, что в Польском королевстве стало \n                    небезопасно, Вы предлагаете князю отправиться в Венгрию, где правит династия Арпадов. Князь, \n                    соглашаясь на ночной побег из замка, дает Вам в качестве своего дара корзно с золотой обшивкой \n                    и красным подкладом с петлицей. Взяв его, Вы вместе с князем спускаетесь по винтовой лестнице \n                    замка и направляетесь прямиком к конюшне. Оседлав коней, вы пускаетесь на юг – \n                    в земли Венгерского королевства.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/4.png" alt="Корзно с золотой обшивкой и красным подкладом с петлицей">\n                <figcaption class="text-img-author text-medium">Корзно с золотой обшивкой и красным подкладом с петлицей</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    ',"choice-2":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    ы отбиваетесь от врагов в одиночестве, подвергая свою жизнь смертельной опасности. \n                    С большим трудом, но Вам удается победить их. Немного отдышавшись, Вы отправляетесь к замку. \n                    Около стен замка Вы видите князя, смотрящего на небо. Вы подходите к нему.\n                    <br>\n                    <br>\n                    Ошеломленный князь медленно садится на траву, слегка окропленную вечерней росой. \n                    Он не испуган, но весьма подавлен случившимся. Понимая, что в Польском королевстве \n                    стало небезопасно, Вы предлагаете князю отправиться в Венгрию, где правит династия \n                    Арпадов. Князь, соглашаясь на ночной побег из замка, дает Вам в качестве своего дара \n                    корзно с золотой обшивкой и красным подкладом с петлицей. Взяв его, Вы вместе с князем \n                    спускаетесь по винтовой лестнице замка и направляетесь прямиком к конюшне. \n                    Оседлав коней, вы пускаетесь на юг – в земли Венгерского королевства.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/4.png" alt="Корзно с золотой обшивкой и красным подкладом с петлицей">\n                <figcaption class="text-img-author text-medium">Корзно с золотой обшивкой и красным подкладом с петлицей</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n    ',"choice-3":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/6.png" alt="Пленение поляками Володаря Ростиславича Перемышльского">\n                <figcaption class="text-img-author text-medium">Пленение поляками при посредничестве Петра Власта (ум. 1153 г.) Володаря Ростиславича Перемышльского (ум. 1124 г.). 1122 г. Миниатюра из Радзивилловской летописи (рукопись конца XV в.).</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    ы сбегаете в лес, изредка оглядываясь назад. Вы видите, что Вашего князя убивают. \n                    На второй день блужданий по лесу Вы набредаете на неприметный домик знахаря. \n                    Всю оставшуюся жизнь Вы живете у него, помогая готовить снадобья \n                    и пытаясь забыть то, что совершили.\n                    </div>\n                </div>\n                <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    '},{page:'\n        \n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/7.png" alt="Бегство полков Владимира Галицкого">\n                            <figcaption class="text-img-author text-medium">Бегство полков Владимира Володаревича Галицкого (ум. 1153 г.) от войск Изяслава Мстиславича Киевского (ум. 1154 г.) и венгерского короля Гезы II (1130–1162) из-под Санока и избиение бегущих. 1152 г. Миниатюра из Радзивилловской летописи (рукопись конца XV в.)</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <div class=\'text text-small\'> \n                            Через несколько дней пути Вы со своим князем прибываете ко двору \n                            венгерского монарха. На следующий день, отдохнув в выделенных покоях, \n                            Вы начинаете вести переговоры. Как ни странно, Вы обнаруживаете, \n                            что пришлись ко двору: венгерское войско как раз ведет войну \n                            с дружинами князей юго-западной Руси. Так как до венгерского правителя \n                            дошли слухи о Вашей доблести на польском боевом турнире, \n                            он желает видеть такого бравого воина в своих рядах, обещая, \n                            что после победы над русскими князьями один из княжеских столов достанется \n                            Вашему князю. \n                            </div>\n                        </div>\n                        <button id="choice" class="menu__button text-medium">Что скажете на предложение короля?</button>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n        ',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Думаю, лучше не стоит сейчас идти в поход. Мы еще не готовы. Нужно переждать несколько месяцев.</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Это предложение нам по душе! Пора молодому князю занять свое истинное место среди Рюриковичей! Седлайте коней! Мы разгромим эту горстку русских князей!</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Идти на кого-то войной?! Ну нет… Князь еще слишком молод, чтобы участвовать в боевых действиях. Правда, князь?!</button></li>',"choice-1":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/7.png" alt="Бегство полков Владимира Галицкого">\n                <figcaption class="text-img-author text-medium">Бегство полков Владимира Володаревича Галицкого (ум. 1153 г.) от войск Изяслава Мстиславича Киевского (ум. 1154 г.) и венгерского короля Гезы II (1130–1162) из-под Санока и избиение бегущих. 1152 г. Миниатюра из Радзивилловской летописи (рукопись конца XV в.)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li> \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    енгерский король соглашается с Вами. Необходимо собрать силы, \n                    и только тогда нанести мощный удар противнику и завоевать земли для Вашего князя.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>  \n    ',"choice-2":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    енгерский король явно впечатлен Вашей решительностью, однако просит Вас \n                    повременить с походом: нужно собрать силы, и только тогда нанести \n                    мощный удар противнику.\n                    <br>\n                    <br>\n                    Несмотря на то, что король решил отложить поход, он впечатлен Вашей удалью \n                    и желанием скорее вступить в бой. Вы получаете от него мадьярскую саблю – оружие, \n                    которое хранилось в чертогах венгерских правителей уже около двух столетий. \n                    К Вашему удивлению, сабля за это время нисколько не износилась, напротив, \n                    отличалась большой удобностью и быстротой. \n                    С таким клинком можно отвоевать любое княжество!\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/5.png" alt="Мадьярская сабля">\n                <figcaption class="text-img-author text-medium">Мадьярская сабля</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n    ',"choice-3":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/7.png" alt="Бегство полков Владимира Галицкого">\n                <figcaption class="text-img-author text-medium">Бегство полков Владимира Володаревича Галицкого (ум. 1153 г.) от войск Изяслава Мстиславича Киевского (ум. 1154 г.) и венгерского короля Гезы II (1130–1162) из-под Санока и избиение бегущих. 1152 г. Миниатюра из Радзивилловской летописи (рукопись конца XV в.)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterM.svg" alt="Буква M" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    олодой князь явно не согласен с Вами. Он видит, что Вы не готовы \n                    к настоящей схватке. Он заявляет Вам, что более не нуждается в Вашей помощи. \n                    Ваш князь становится пешкой в делах венгерской внешней политики, \n                    а Вы – изгоем на чужбине.\n                    </div>\n                </div>\n                <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    '},{page:'\n        \n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/8.png" alt="Геза II и Евфросинья Мстиславна принимают её брата Владимира Мстиславича">\n                            <figcaption class="text-img-author text-medium">Геза II (1130–1162) и Евфросинья Мстиславна (1130–1193) принимают её брата Владимира Мстиславича. Миниатюра из Лицевого летописного свода (XVI век)</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterP.svg" alt="Буква P" class=\'img-letter-small\'>\n                            <div class=\'text text-small\'> \n                            осле переговоров с королем Вы получаете весточку от венгерской королевы \n                            с приглашением в ее покои. Вы соглашаетесь прийти. \n                            После начала разговора, Вы узнаете, что королева – русская княжна, \n                            дочь самого киевского великого князя.\n                            </div>\n                        </div>\n                        <button id="choice" class="menu__button text-medium">Когда разговор прекращается, Вы решаете…</button>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n        ',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Оставить королеву и уйти в свои покои. Пожалуй, лучше не докучать ей лишней болтовней</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Рассказать королеве о планах Вашего князя свергнуть брата королевы, сидящего на киевском престоле и воссесть на него самому</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Взять музыкальный инструмент, лежащий у постели королевы. Такой инструмент Вы видели у одного заезжего трубадура-франка в Польше. Он даже научил Вас немного на нем играть. Кажется, он называется «колесная лира». Нужно взять его и попробовать сыграть королеве что-то из русских мотивов. Устала она, наверное, жить так далеко от родных краев…</button></li>',"choice-1":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/8.png" alt="Геза II и Евфросинья Мстиславна принимают её брата Владимира Мстиславича">\n                <figcaption class="text-img-author text-medium">Геза II (1130–1162) и Евфросинья Мстиславна (1130–1193) принимают её брата Владимира Мстиславича. Миниатюра из Лицевого летописного свода (XVI век)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li> \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterP.svg" alt="Буква П" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    опрощавшись с королевой, поблагодарив ее за разговор, Вы возвращаетесь \n                    в свои покои. Ничего плохого не произошло, но и хорошего тоже . День завершен, \n                    и Вам пора отходить ко сну…\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>  \n    ',"choice-2":' \n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/8.png" alt="Геза II и Евфросинья Мстиславна принимают её брата Владимира Мстиславича">\n                <figcaption class="text-img-author text-medium">Геза II (1130–1162) и Евфросинья Мстиславна (1130–1193) принимают её брата Владимира Мстиславича. Миниатюра из Лицевого летописного свода (XVI век)</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li> \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterK.svg" alt="Буква K" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    оролева, затаив на Вас и князя обиду, прощается с Вами. На следующий день \n                    Вы узнаете от короля, что он отказывается идти с Вами в поход, потому что, \n                    когда давал свое согласие, не знал о Ваших планах занять киевский стол. \n                    Вы не знаете, что делать дальше: все мечты рухнули, осталось лишь доживать свой век…\n                    </div>\n                </div>\n                <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    ',"choice-3":'\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterR.svg" alt="Буква Р" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    астроганная королева очень благодарна Вам, она увидела в Вас своего друга и союзника.\n                    <br>\n                    <br>\n                    Вам удалось впечатлить королеву. От воспоминаний родного края слезы сами невольно \n                    навернулись на ее глазах. Вы несколько часов провели за разговорами \n                    о Русской земле и тяготах чужбины. На прощание королева достала для Вас из сундука \n                    золотую шейную гривну. Удалившись в свои покои, Вы начали рассматривать ее, \n                    задумавшись о такой близкой, но такой далекой Русской земле…\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/6.png" alt="Золотая шейная гривна">\n                <figcaption class="text-img-author text-medium">Золотая шейная гривна</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n    '},{page:'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/10.png" alt="Похороны Андрея Боголюбского">\n                <figcaption class="text-img-author text-medium">Похороны Андрея Боголюбского (ум. 1174 г.). Миниатюра из Лицевого летописного свода (XVI в.). Российская национальная библиотека.</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n    </li>\n\n    <li class="page">\n        <div class="page-content content-text">\n            <div class=\'main-text\'> \n                <img src="assets/letter/letterH.svg" alt="Буква И" class=\'img-letter-small\'>\n                <div class=\'text text-small\'> \n                    Через пару дней Вы узнаете о смерти одного из младших сыновей короля. Он и королева присылают Вам и князю приглашение на похороны принца.\n                </div>\n            </div>\n            <button id="choice" class="menu__button text-medium">Вы…</button>\n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n        </div>\n    </li>\n        ',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Публично заявлю, что не собираюсь идти на похороны этого сорванца. Нашли куда звать!</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Необходимо принять приглашение и проводить в последний путь этого достойного юношу.</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Думаю, стоит их оставить наедине со своим горем, послав лишь скромное послание-соболезнование.</button></li>',"choice-1":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/10.png" alt="Съезд князей">\n                <figcaption class="text-img-author text-medium">Похороны Андрея Боголюбского (ум. 1174 г.). Миниатюра из Лицевого летописного свода (XVI в.). Российская национальная библиотека.</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterM.svg" alt="Буква M" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    онаршая чета раздосадована Вашими\n                    словами и отказом. Вас лишают\n                    королевского благоволения и выгоняют из замка. Теперь Вас и Вашего князя ждет жизнь скитальцев без всякой надежды на занятие престола в одном из русских княжеств.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    ',"choice-2":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterP.svg" alt="Буква П" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    оролевская чета благодарна Вам за согласие. \n                    <br>\n                    <br>\n                    Согласившись отправиться на похороны сына короля, Вы должны были одеться подобающим образом. \n                    В качестве признания за Ваше согласие проводить принца в последний путь, королевская чета прислала Вам черный мятель,\n                    который Вы накинули на свое одеяние, отправившись в собор.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/3.png" alt="Черный мятель">\n                <figcaption class="text-img-author text-medium">Черный мятель</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    ',"choice-3":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/10.png" alt="Похороны Андрея Боголюбского">\n                <figcaption class="text-img-author text-medium">Похороны Андрея Боголюбского (ум. 1174 г.). Миниатюра из Лицевого летописного свода (XVI в.). Российская национальная библиотека.</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterK.svg" alt="Буква И" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    оролевская чета не поняла Ваш\n                    отказ проводить в последний путь их\n                    сына, но приняла Ваши соболезнования.\n                    </div>\n                </div>\n                <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    '},{page:'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/11.png" alt="Венгерский король">\n                <figcaption class="text-img-author text-medium">Венгерский король Бела III (ок. 1148–1196). Миниатюра из Венгерской иллюстрированной хроники (вторая половина XIV в.). Национальная библиотека им. Сеченьи (Венгрия).</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n    </li>\n\n    <li class="page">\n        <div class="page-content content-text">\n            <div class=\'main-text\'> \n                <img src="assets/letter/letterH.svg" alt="Буква И" class=\'img-letter-small\'>\n                <div class=\'text text-small\'> \n                Через какое-то время Вы узнаете, что венгерский король не готов отправиться с Вами в поход на юго-западные русские княжества: он тоскует по своему ушедшему сыну, да и князья прекратили вражду между собой и объединились вокруг одного представителя династии. Король просит Вас простить его и попытать счастья в других частях ойкумены.\n                </div>\n            </div>\n            <button id="choice" class="menu__button text-medium">Вы решаете…</button>\n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n        </div>\n    </li>\n        ',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Обратиться к одному из старших сыновей короля. Говорят, он поклонник византийских обычаев и нравов и, вполне возможно, имеет связи в Царьграде. Он мог бы помочь нам с князем туда добраться, чтобы продолжить поиск союзников в борьбе за престол…</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Плюнуть королю в лицо. Тот король, что не умеет держать свои обещания, не достоин называться владыкой сей державы!</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Попросить у короля денег на боевых наемников, чтобы отправиться с ними завоевывать землю для князя.</button></li>',"choice-1":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterP.svg" alt="Буква П" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    Действительно, сын венгерского короля оказался поклонником императорского двора. \n                    Там у него есть множество влиятельных знакомых. \n                    Принц соглашается помочь Вам отправиться в столицу Державы Ромеев.\n                    <br>\n                    <br>\n                    В знак благодарности за путешествие в Византию, Вы получаете от князя сафьяновые сапоги с золотым узором. \n                    Купленные на одном из венгерских рынков у русского торговца, они пригодятся Вам при ромейском императорском дворе, где ценят красоту.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/7.png" alt="Сафьяновые сапоги с золотым узором">\n                <figcaption class="text-img-author text-medium">Сафьяновые сапоги с золотым узором</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    ',"choice-2":'\n    <li class="page">\n    <div class="page-content content-img">\n        <figure>\n        <img class="content-img" src="assets/image/11.png" alt="Венгерский король">\n        <figcaption class="text-img-author text-medium">Венгерский король Бела III (ок. 1148–1196). Миниатюра из Венгерской иллюстрированной хроники (вторая половина XIV в.). Национальная библиотека им. Сеченьи (Венгрия).</figcaption>                     \n        </figure>                       \n        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n    </div>\n    </li>    \n\n    <li class="page">\n        <div class="page-content content-text">\n            <div class=\'main-text\'> \n                <img src="assets/letter/letterC.svg" alt="Буква C" class=\'img-letter-small\'>\n                <div class=\'text text-small\'> \n                тража подбегает и арестовывает Вас.\n                Последние дни Вы проведете в сырой\n                камере, пока Вас не казнят за оскорбление Его Величества…\n                </div>\n            </div>\n            <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n        </div>\n    </li>\n',"choice-3":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n            <img class="content-img" src="assets/image/11.png" alt="Венгерский король">\n            <figcaption class="text-img-author text-medium">Венгерский король Бела III (ок. 1148–1196). Миниатюра из Венгерской иллюстрированной хроники (вторая половина XIV в.). Национальная библиотека им. Сеченьи (Венгрия).</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterK.svg" alt="Буква K" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    ороль соглашается дать Вам золото.\n                    Вы нанимаете на него дюжину\n                    конников-головорезов. Достигая пределов Руси, Вы встречаете войско местных князей, которые знали о Вашем появлении. \n                    Понимая, что окружены, Ваши наемники разворачивают коней и бегут обратно в венгерские владения. \n                    Вас вместе с князем берут в заложники и ослепляют. \n                    Вы больше не представляете опасности как политические соперники…\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    '},{page:'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <img class="content-img" src="assets/image/12.png" alt="Император Мануил">\n                <figcaption class="text-img-author text-medium">Император Мануил I Комнин (1118–1180) с супругой императрицей Марией Антиохийской (1145–1182). Миниатюра 1166 г. Ватиканская апостольская библиотека.</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n    </li>\n\n    <li class="page">\n        <div class="page-content content-text">\n            <div class=\'main-text\'> \n                <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                <div class=\'text text-small\'> \n                скоре Вы прибываете в \n                Константинополь. Поражаясь \n                великолепному и богатому убранству императорского дворца, Вы приходите на аудиенцию к василевсу. Рассказывая императору о князе и о себе, Вы просите его помочь вам золотом или войсками в деле завоевания княжеского престола. Взамен Вы обещаете признать себя вассалом (hypospondos) василевса и участвовать в будущем во всех его военных походах. Византийский император принимает Ваше предложение, однако, просит стать его вассалом сейчас же и выполнить важную дипломатическую миссию, поехав в Иерусалимское королевство для достижения соглашения с крестоносцами о совместном завоевании Египта. Если Вы согласитесь, Вам необходимо будет переговорить с аколуфом варяжской гвардии для выделения Вам боевой охраны.\n                </div>\n            </div>\n            <button id="choice" class="menu__button text-medium">Что Вы намерены ответить василевсу?</button>\n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n        </div>\n    </li>\n        ',"btn-1":'<li><button id="choice-1" class="text-medium button-answer">Нужно ответить императору согласием. При этом его нужно удивить нашей храбростью! Мы откажемся от сопровождения варяжской гвардией. Оставив князя в этом великолепном дворце, я отправлюсь в Святую землю лично, где встречусь с латинским королем.</button></li>',"btn-2":'<li><button id="choice-2" class="text-medium button-answer">Кто мы такие, чтобы отказывать великому православному правителю? Мы принимаем предложение. Я готов переговорить с аколуфом сейчас же!</button></li>',"btn-3":'<li><button id="choice-3" class="text-medium button-answer">Он хочет нас обмануть! Не стоит принимать его предложение! К тому же можно просто сгинуть по пути в Святую землю!</button></li>',"choice-1":'\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n            <img class="content-img" src="assets/image/12.png" alt="Император Мануил">\n            <figcaption class="text-img-author text-medium">Император Мануил I Комнин (1118–1180) с супругой императрицей Марией Антиохийской (1145–1182). Миниатюра 1166 г. Ватиканская апостольская библиотека.</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>    \n\n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    асилевс удивлен Вашей \n                    безрассудностью, но соглашается с\n                    Вами. Через пару дней, после кратковременного отдыха, Вы отправляетесь в Святую землю.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n    ',"choice-2":' \n        <li class="page">\n            <div class="page-content content-text">\n                <div class=\'main-text\'> \n                    <img src="assets/letter/letterU.svg" alt="Буква И" class=\'img-letter-small\'>\n                    <div class=\'text text-small\'> \n                    мператор доволен Вашим согласием.\n                    Он приказывает своим слугам \n                    сопроводить Вас к аколуфу. Встретившись с ним в окружении грозных варягов, \n                    Вы получаете согласие на выделение боевого сопровождения. \n                    После кратковременного отдыха Вы отправляетесь в Святую землю.\n                    <br>\n                    <br>\n                    Удовлетворив василевса своим согласием и получив одобрение от аколуфа варяжской гвардии, \n                    Вы отправились в свои покои. Вскоре в Вашу дверь постучались. \n                    Вам преподнесли щит, обтянутый бархатом, подарок от императора. \n                    Слуга, принесший щит, передал Вам и устное послание от него: в случае успешной дипломатической миссии, он хотел бы видеть \n                    Вас рядом с севастократором в рядах лучших конников Державы Ромеев для скорого похода на Египет.\n                    </div>\n                </div>\n                <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n            </div>\n        </li>\n\n        <li class="page">\n        <div class="page-content content-img">\n            <figure>\n                <h2 class=\'text-trophy\'>Получен трофей:</h2>\n                <img class="content-img" src="assets/trophy/8.png" alt="Щит, обтянутый бархатом">\n                <figcaption class="text-img-author text-medium">Щит, обтянутый бархатом</figcaption>                     \n            </figure>                       \n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n        </div>\n        </li>   \n    ',"choice-3":'\n    <li class="page">\n    <div class="page-content content-img">\n        <figure>\n            <img class="content-img" src="assets/image/12.png" alt="Император Мануил">\n            <figcaption class="text-img-author text-medium">Император Мануил I Комнин (1118–1180) с супругой императрицей Марией Антиохийской (1145–1182). Миниатюра 1166 г. Ватиканская апостольская библиотека.</figcaption>                     \n        </figure>                       \n        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n    </div>\n    </li>    \n\n    <li class="page">\n        <div class="page-content content-text">\n            <div class=\'main-text\'> \n                <img src="assets/letter/letterB.svg" alt="Буква B" class=\'img-letter-small\'>\n                <div class=\'text text-small\'> \n                асилевс разочарован в Вас и в \n                Вашем князе. Без вашего согласия он\n                не готов оказывать свою помощь. Он не изгоняет вас из Царьграда, но вы просто продолжаете тихо доживать свой век при императорском дворе…\n                </div>\n            </div>\n            <button id="choice" class="menu__button text-medium" onclick="location.reload(); return false;">Начать игру заново</button>\n            <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n        </div>\n    </li>\n'}],n=document.querySelector("#start"),a=document.querySelector("#btns"),o=document.querySelector(".menu__right"),r=document.querySelector(".menu"),c=(document.querySelector("#test"),0);function l(t){return new Promise((function(e){return setTimeout(e,t)}))}function g(t,s){var n=document.querySelector(".container");n.classList.remove("move-right"),n.classList.add("move-left");var a,o,d=(a="\n    <ul class='list-answer'>\n        ".concat(i[c]["btn-1"],"\n        ").concat(i[c]["btn-2"],"\n        ").concat(i[c]["btn-3"],"\n    </ul>\n    "),(o=document.createElement("div")).innerHTML=a,o.firstElementChild);r.insertAdjacentElement(e.BEFOREEND,d),s.target.disabled=!0,s.target.id="disabled",l(3e3).then((function(){var e=document.querySelector("#choice-1"),s=document.querySelector("#choice-2"),a=document.querySelector("#choice-3"),o=function(e){if("chosen"!=e.target.id){var s=e.target.id.slice(-1);e.target.id="chosen";for(var a=1;a<4;a++)String(a)!==s&&(document.querySelector("#choice-".concat(a)).disabled=!0);1==s&&(h(i[c]["choice-1"],t),l(2e3).then((function(){t.flipNext()}))),2==s&&(h(i[c]["choice-2"],t),l(2e3).then((function(){t.flipNext()}))),3==s&&(h(i[c]["choice-3"],t),l(2e3).then((function(){t.flipNext()}))),l(500).then((function(){d.remove(),n.classList.add("move-right"),n.classList.remove("move-left")})),function(t){7!=c&&(h(i[c+=1].page,t),document.querySelector("#choice").addEventListener("click",(function(e){g(t,e)})))}(t)}};e.addEventListener("click",o),s.addEventListener("click",o),a.addEventListener("click",o)}))}function h(t,e){var s="".concat(t);null!=document.querySelector(".stf__block")?document.querySelector(".stf__block").insertAdjacentHTML("beforeend",s):console.log("no"),e.updateFromHtml(document.querySelectorAll(".page"))}n.addEventListener("click",(function(){a.classList.add("is-hidden"),l(200).then((function(){a.remove(),o.remove()})),r.innerHTML='\n    <div class="container1">\n          <div class="open-book">\n            <div class="flip-book" id="demoBookExample">\n                <div id="page" class="cover page-cover-top page-test">\n                </div>\n                <div id="page" class="page1 right-br">\n                </div>\n                <div id="page" class="page2 left-br">\n                </div>\n            </div>\n          </div>\n        </div>\n        ';var e=new t.PageFlip(document.getElementById("demoBookExample"),{width:640,height:882,size:"fixed",drawShadow:!1,showCover:!0,usePortrait:!1,mobileScrollSupport:!1,useMouseEvents:!1,flippingTime:1100}),s=document.querySelector(".page1"),i=document.querySelector(".page2");e.loadFromHTML(document.querySelectorAll("#page")),l(20).then((function(){e.flipNext()})),l(500).then((function(){s.classList.remove("right-br"),i.classList.remove("left-br")})),l(1300).then((function(){e.destroy(),document.querySelector(".container1").remove(),r.innerHTML='\n    <div class="container">\n          <div class="wrapper-book">\n            <ul class="flip-book" id="demoBookExample">\n\n                <li class="page">\n                    <div class="page-content content-text first">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterU.svg" alt="Буква И" class=\'img-letter-high\'>\n                            <div class=\'text text-high\'> \n                                стория средних веков менее\n                                всего может назваться скучною.\n                                Нигде нет такой пестроты, такого живого действия,\n                                таких резких противоположностей, такой странной яркости, как в ней:\n                                ее можно сравнить с огромным строением, в фундаменте которого улегся свежий,\n                                крепкий, как вечность, гранит, а толстые стены выведены из различного, старого и нового материала,\n                                так что на одном кирпиче видны готфские руны, на другом блестит римская позолота; арабская резьба,\n                                греческий карниз, готическое окно, – все слепилось в нем и составило самую пеструю башню”\n                            </div>\n                        </div>\n                        <div class=\'main-text text-high\'>(Н. В. Гоголь, “О средних веках”)</div>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n\n                <li class="page">\n                    <div class="page-content content-img first">\n                        <figure>\n                            <img class="content-img" src="assets/image/1-Gogol.png" alt="Портрет Гоголя">\n                            <figcaption class="text-img-author text-medium">Ф. А. Моллер. Портрет Гоголя (Третьяковская галерея, 1841 г.)</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n\n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterH.svg" alt="Буква Н" class=\'img-letter-small\'>\n                            <div class=\'text text-small\'> \n                                а землях Руси настали поистине смутные времена. Могущественные\n                                княжеские кланы готовы вступить в ожесточенную борьбу за власть и влияние. \n                                Князья-изгои, оскорбленные лишением земель, уже точат свои мечи и не спешат убирать их обратно в ножны. \n                                Владетели крупных княжеств собирают свои дружины, чтобы отстоять свои права перед другими представителями разросшейся семьи Рюриковичей. \n                                Бурное развитие сел и городов прерывается набегами половцев, зачастую приглашаемых на Русскую землю самими русскими князьями. \n                                Бал начинает править кровавая эпоха раздробленности...\n                                Вы – молодой дружинник по имени Василько, состоящий в дружине у князя-изгоя, которому не досталось места в “семейном владении Рюриковичей”. \n                                Его отец, также князь-изгой, всю свою жизнь провел в битвах со своими родичами, но, как только захватил княжеский стол, \n                                был отравлен своим же поваром по прозвищу Поганка. \n                            </div>\n                        </div>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n                \n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/2.png" alt="Съезд князей">\n                            <figcaption class="text-img-author text-medium">И. Билибин. Рисунок “Съезд князей”</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                \n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterB.svg" alt="Буква В" class=\'img-letter-small\'>\n                            <div class=\'text text-small\'> \n                            аша задача – выжить в жестоком\n                            мире удельной раздробленности и \n                            попытаться, заручившись верными союзниками и братьями-дружинниками, \n                            добиться для своего князя власти в каком-либо княжестве, поправ врагов и восстановив честь клана!\n                            <br>\n                            <br>\n                            Вас ждет невероятное путешествие по землям Восточной Европы, в ходе которого Вы будете вести битвы, \n                            плести интриги, торговать и вступать в переговоры. Любое Ваше решение будет иметь последствия: \n                            за каждый выбранный Вами ход Вы получите определенное количество очков, а также, если повезет, трофейный предмет, \n                            который прибавит Вам итоговых очков в конце игры. Чем больше Вы наберете очков в течение игры – тем лучше результат!               \n                            </div>\n                        </div>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/2.png" alt="Съезд князей">\n                            <figcaption class="text-img-author text-medium">И. Билибин. Рисунок “Съезд князей”</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterB.svg" alt="Буква В" class=\'img-letter-small\'>\n                            <div class=\'text text-small\'> \n                                течение игры каждый ход Вам будет \n                                предлагаться выбор из трех или двух\n                                вариантов ответа, от которого будет зависеть судьба Вашего героя и князя, за которым Вы стоите. \n                                Наиболее успешный выбор даст дружиннику большее количество очков. От выбора зависит и достаток Вашего героя: \n                                за те или иные ходы Вы будете получать трофеи, которые также влияют на конечный результат борьбы за княжеский стол. \n                                Будьте внимательны: некоторые варианты ответа могут привести Вас и Вашего князя к гибели или к бесславному окончанию путешествия, выбирайте с умом!\n                                <br>\n                                <br>\n                                Ваша цель – выжить, заручиться союзниками и захватить княжеский престол для своего князя.\n                                <br>\n                                <br>\n                                Кроме того, по ходу игры некоторые слова будут выделяться особым маркером. Это будет означать, \n                                что у данного слова существует историческая справка – объяснение понятия с возможной краткой историографией.           \n                            </div>\n                        </div>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/3.png" alt="Съезд князей">\n                            <figcaption class="text-img-author text-medium">Памятник Любечкому съезду князей. Памятник скульптора Геннадия Ершова, расположенный в Любече на берегу Днепра (Украина, 1997 г.)</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-img">\n                        <figure>\n                            <img class="content-img" src="assets/image/4.png" alt="Съезд князей">\n                            <figcaption class="text-img-author text-medium">Отравление Ростислава Владимировича Тмутараканского, первого князя-изгоя, греческим стратигом. Миниатюра из Радзивилловской летописи (XV век)</figcaption>                     \n                        </figure>                       \n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>    \n                    </div>\n                </li>\n\n                <li class="page">\n                    <div class="page-content content-text">\n                        <div class=\'main-text\'> \n                            <img src="assets/letter/letterH.svg" alt="Буква И" class=\'img-letter-small\'>\n                            <div class=\'text text-small\'> \n                            аходясь при особе своего князя, Вы,\n                            к своему стыду, не сумели уберечь\n                            его от отравления, совершенного коварным поваром по прозвищу Поганка. Не только могущество и влияние, но и само выживание княжеского клана, \n                            к которому он принадлежал, подверглись угрозе. Пока бурное развитие сел и городов прерывается набегами половцев, \n                            зачастую приглашаемых на Русскую землю самими русскими князьями, Вы рискуете остаться за бортом Истории. \n                            Однако, судьба дала Вам второй шанс в лице его молодого наследника. Несмотря на то, что княжеский стол потерян, честь клана попрана, \n                            а молодой и неопытный Рюрикович превращен в князя-изгоя, Вы решаете начать искать союзников для возвращения отчины, \n                            чтобы занять достойное место в “семейном владении Рюриковичей”.\n                            </div>\n                        </div>\n                        <button id="choice" class="menu__button text-medium">Что Вы намерены делать в первую очередь?</button>\n                        <div class=\'decor\'><img src="assets/decor-1.svg" alt="" class="img-decor"></div>\n                    </div>\n                </li>\n            </ul>\n        </div>\n    </div>\n';var s=new t.PageFlip(document.getElementById("demoBookExample"),{width:550,height:803,size:"stretch",minWidth:315,maxWidth:1e3,minHeight:800,maxHeight:1350,drawShadow:!1,showCover:!1,usePortrait:!1,mobileScrollSupport:!1});s.loadFromHTML(document.querySelectorAll(".page")),document.querySelector("#choice").addEventListener("click",(function(t){g(s,t)}))}))}))}()}();